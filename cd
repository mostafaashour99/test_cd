pipeline {
    agent any
    environment { 
        CREDENTIALS_ID = 'mostafa-ashour-project'
    }
    stages {
	    stage('Apply Kubernetes files') {
	     steps {
	     sh 'apt-get update && apt-get install kubectl -y'
	    withKubeConfig([credentialsId: env.CREDENTIALS_ID, serverUrl: 'https://172.16.0.2']) {
	      sh 'kubectl apply -f deployment.yaml -n prod'
	    }
	    }
  }    
}
}
